% Define document class
\documentclass[preprint]{aastex631}
\usepackage{showyourwork}

% Begin!
\begin{document}
	
\newcommand{\ergsec}{erg s$^{-1}$ cm$^{-2}$ $\mu$m$^{-1}$}

% Title
\title{Keck Near-Infrared Observations of Mab}

% Author list
%\author{@emolter}
\author[0000-0003-3799-9033]{Edward M. Molter}
\affiliation{Earth and Planetary Science Department, University of California, Berkeley, CA 94720, USA}
\correspondingauthor{Edward M. Molter}
\email{emolter@berkeley.edu}

\author{Imke de Pater}
\affiliation{Earth and Planetary Science Department, University of California, Berkeley, CA 94720, USA}

\author{Chris Moeckel}
\affiliation{Earth and Planetary Science Department, University of California, Berkeley, CA 94720, USA}


\begin{abstract}
We report the first near-infrared detection of Uranus's smallest known moon Mab, the presumed source of the blue and diffuse $\mu$ ring, using the NIRC2 instrument at Keck Observatory. The detection was permitted by an updated shift-and-stack procedure allowing us to track Mab across the detector in 23 separate exposures taken over $\sim$2 hours, as well as the very low (0.02$^\circ$) phase angle at the time of observation.
At this phase angle, Mab has an integrated I/F of 
\variable{output/Mab_urh_intif.txt} $\pm$ \variable{output/Mab_urh_intiferr.txt} km$^{2}$ 
at 1.6 $\mu$m and 
\variable{output/Mab_urk_intif.txt} $\pm$ \variable{output/Mab_urk_intiferr.txt} km$^{2}$ 
at 2.1 $\mu$m. 
Comparing these values with Mab's visible reflectance as derived by HST reveals that Mab is spectrally blue; its (0.5 $\mu$m)/(1.6 $\mu$m) color is more consistent with Miranda's value than Puck's value. We therefore propose that Mab is more likely a $\sim$6-km radius body with a Miranda-like surface than a 12-km radius body with a Puck-like surface, but we caution that a Puck-like color is only ruled out at the 2$\sigma$ level.
We also report (the first?) infrared photometry of Ophelia, (Cordelia?), and Perdita.
\end{abstract}

\keywords{}

% Main body with filler text
\section{Introduction}
\label{s:intro}

% does the below text fit in anywhere?
The small regular moons comprising the Portia group in the Uranian system represent the most densely-packed set of satellites known, with semimajor axis separations of 3\% on average \citep{showalter20}; as such, the system is predicted to be chaotic, with collisions occurring on 10$^5$- to 10$^7$-year timescales \citep{duncan97, french12}. Indeed, the faint dusty $\nu$ ring, situated between the orbits of Portia and Rosalind, has been proposed to be the remnant of such a collision. Due in part to this small orbital spacing, the Uranian satellites affect each other's geology via dust transport in the circumplanetary environment. For example, dust deposition from Uranus's outer irregular satellites has been invoked to explain spectral reddening of the leading hemispheres of Ariel, Umbriel, Titania, and Oberon \citep{cartwright18}. Material transport is important for understanding the surfaces of Miranda, Puck, and the smaller inner moons, too, but these processes are less well-studied. 
Puck's leading hemisphere has a significantly bluer spectral slope than its trailing hemisphere, meaning that it may be sweeping up material from the $\mu$ ring \citep{french17}. %this is a DPS abstract - is there a better reference?
Unusually low depth/diameter ratios of craters on the potential ocean world Miranda suggest the deposition of a $\sim$1 km thick regolith \citep{cartwright21, beddingfield22}. Those authors propose three possible sources of the regolith material: deposition from the $\mu$ ring, plume deposits from a subsurface ocean, and/or giant impact ejecta.

The faint, diffuse $\mu$ ring is therefore crucial for understanding the evolution of Uranus's circumplanetary system as a whole, but its properties and origin remain poorly understood.
It is the only ring in the solar system with a blue spectrum other than Saturn's E ring, which is sourced from Enceladus's cryovolcanism \citep{depater06}. The E~ring is blue due to its abundance of tiny ($\lesssim$1 $\mu$m) particles and paucity of larger grains \citep{showalter91, depater04, hillier07}. The tiny moon Mab is embedded in, and is the presumed source of, the $\mu$ ring, but active cryovolcanism on such a small body seems highly unlikely. Instead, it has been proposed that Mab outbursts like the active Centaur Echeclus, with the blue color of the $\mu$ ring attributable not to small particle sizes but to a high abundance of carbon-rich organic matter \citep{seccull19}. Alternatively, interplanetary dust and/or charged plasma impacting Mab's surface may liberate enough particles to form the $\mu$ ring. To explain the blue color, the latter scenario relies on theoretical and numerical simulation expectations that $\sim$1 $\mu$m particles are more likely than larger particles to disperse into a ring (instead of re-accreting to the planet) under the combined influences of gravity, radiation pressure, and electromagnetic forces \citep{horanyi92, sfair09, sfair12}. In any case, the physical properties of this unusual moon are of interest for studies of interactions between airless surfaces and the interplanetary environment, the origin and dynamical evolution of circumplanetary dust, and the formation and evolution of small solar system bodies.

The HST observations that discovered Mab could not uniquely constrain its radius and albedo, which are degenerate with respect to the reflected flux of an unresolved body \citep{showalter06}. Those authors proposed two end-member cases: Mab has a $\sim$6 km radius with a Miranda-like icy surface and an albedo of $\sim$0.46; or Mab has a $\sim$12 km radius and an albedo of $\sim$0.1, indicating the presence of dark organic compounds on its surface like its other nearest neighbor, Puck. A previous near-infrared search with Keck did not detect the moon, leading to the proposal that Mab's radius is $\lesssim$6 km and as dark at wavelengths from 1.6-2.4 $\mu$m as Puck \citep[albedo $\lesssim$0.11;][]{paradis19, paradis23}. Strong near-IR absorption from water ice could partially account for this darkening; however, the decrease in brightness is not expected to exceed 50\% even for a very icy body \citep[c.f. Haumea, one of the purest amorphous ice surfaces in the solar system;][]{gourgeot16}.

Here we present the first observations of Mab at near-infrared wavelengths. Our dataset and data proceessing steps are described in Section \ref{s:observations}. We present photometry of Mab, as well as Cordelia, Ophelia, and Perdita, in Section \ref{s:results}, and compare Mab's derived infrared reflectance with the spectra of Miranda and Puck in Section \ref{s:discussion}.

\section{Observations and Data Processing}
\label{s:observations}

This paper makes use of H- and Kp-band data taken on 28 October 2019 by the narrow camera of the NIRC2 instrument coupled to the Adaptive Optics (AO) system at Keck Observatory, using Uranus itself for wavefront sensing \citep{wizinowich00, vandam04}. The same data were analyzed by \citet{paradis23}, so we refer the reader to that paper for a detailed description of the observation and data reduction procedures. The standard star was FS2 from the UKIRT Faint Standard Star list,\footnote{\url{https://www2.keck.hawaii.edu/inst/nirc/UKIRTstds.html}} and standard photometric calibration procedures resulted in calibration constants $C_H = 8.87\times10^{-17}$ and $C_K = 9.11\times10^{-17}$ to convert from 1 count per second to 1 \ergsec{}. The uncertainty in the photometric calibration was estimated from the spread in measured fluxes from the standard star between frames. The value we found was 20\% in both filters, which is typical for NIRC2 observations \citep{depater14, molter19}.

Our full dataset consisted of 23 exposures of 120 seconds each in H-band (1.6 $\mu$m) and 24 exposures of 120 seconds each in Kp-band (2.1 $\mu$m); these were all the frames taken on 28 October 2019 in which Mab's expected position was inside the field of view of the narrow camera (Figure \ref{fig:detection}, left panel).
The proper motion of Mab is roughly 30 mas (3 pixels) per minute, which means that each frame had to be shifted relative to the previous one in accordance with Mab's expected vector of motion to improve the signal-to-noise ratio (SNR). This so-called ``shift-and-stack" technique has been used by other authors to improve the SNR of moving point sources, including to measure photometry of other small moons of Uranus with NIRC2 \citep[][]{paradis19, paradis23}. Our shift-and-stack procedure differs in several ways from the one implemented by those authors, and we describe it fully in Appendix \ref{s:shiftandstack}. The application of shift-and-stack resulted in one stacked image per filter at the expected position of Mab, representing effective integration times of 2760 seconds in H-band and 2880 seconds in Kp-band.

\begin{figure}
\includegraphics[width=0.5\textwidth]{figures/motion_on_detector.png}
\includegraphics[width=0.5\textwidth]{figures/detection_images_Mab.png}
\caption{\textbf{Left:} A single NIRC2 H-band exposure overlaid with the expected position of Mab in each of our 23 H-band and 24 Kp-band exposures. The bright and faint point sources visible in the image are Miranda and Puck, respectively. \textbf{Right:} Detection of Mab in H-band (top panel) and tentative detection in Kp-band (bottom panel) using the shift-and-stack technique.\label{fig:detection}}
\end{figure}

\section{Results}
\label{s:results}

\subsection{Photometry of Mab}

An image of our H-band detection of Mab is shown in the upper right panel of Figure \ref{fig:detection}. The detection is in a low-SNR regime, but we are confident that it is real for three reasons. First, a tentative detection of Mab can be made separately from the first 11 frames and the last 11 frames, meaning that an artefact in a single frame or 8-frame group is not producing a false positive. Second, the detection is located in the appropriate position on the sky relative to Miranda and Puck, as discussed below. Third, we performed an experiment to test the false positive rate of our shift-and-stack procedure under the same scattered light and noise conditions as the data. In short, we added random offsets to the expected position of Mab in each frame, then carried out shift-and-stack in the same way as we did for the true expected position. We repeated this procedure with different random offsets 100 times, and found that no noise spikes as bright as our Mab detection appeared anywhere in any of those 100 stacks; see Appendix \ref{s:falsepositives} for more details.

Because Mab was detected at low SNR and within a substantial scattered light background, the flux in the wings of the PSF could not be accurately measured. We therefore determined the flux of Mab using a flux bootstrapping procedure similar to that applied to Keck-observed point sources by many other authors \citep[e.g.,][]{gibbard05, molter19, paradis23}, the specifics of which we summarize in Appendix \ref{s:bootstrapping}. We find the total flux of Mab to be
(\variable{output/Mab_urh_flux.txt} $\pm$ \variable{output/Mab_urh_fluxerr.txt})$\times10^{-16}$ \ergsec{} 
in H-band, where the error bars indicate a 1-$\sigma$ uncertainty, computed by taking the quadrature sum of the flux bootstrapping error and the 20\% photometric calibration error. This flux level corresponds to an integrated I/F of 
\variable{output/Mab_urh_intif.txt} $\pm$ \variable{output/Mab_urh_intiferr.txt} km$^{2}$ 
at 1.6 $\mu$m, where the integrated I/F is defined as the sky-projected area the moon would have if it were a perfect Lambertian reflector \citep[i.e., a geometric albedo of unity;][]{karkoschka01}. Note that the Sun-target-observer phase angle $\alpha$ of these observations was only 0.02$^\circ$, so the opposition surge was likely substantial, as discussed more in Section \ref{s:discussion}. The sub-solar longitude of Mab passed through 270$^\circ$ during the $\sim$2 hours of observations and the sub-observer latitude was 46$^\circ$, so the reflectance values we report represent an average of the leading and trailing hemispheres.

The observed position of Mab is the same as expected based on the orbital parameters in the JPL Horizons system\footnote{\url{https://ssd.jpl.nasa.gov/horizons/app.html\#/}} to within one Keck resolution element; see Figure \ref{fig:astrometry}. We determined this based on the relative positions of Mab, Miranda, and Puck, the latter two of which can be seen easily in a single 120-second frame. The advantage of using the positions of other moons as a reference for astrometry is that it does not depend on a navigation solution for the planet's disk.

\begin{figure}
\includegraphics[width=0.5\textwidth]{figures/expected_position_urh_Mab_oneframe.png}
\includegraphics[width=0.5\textwidth]{figures/expected_position_urh_Mab.png}
\caption{Two visualizations of Mab's expected position. \textbf{Left:} A single NIRC2 H-band exposure overlaid with the expected relative positions of Mab, Miranda, and Puck (red arrows) as well as the detected position of Mab (blue dot). The expected vector of motion of Mab is also overlain (blue arrow). \textbf{Right:} The same shifted-and-stacked detection image of Mab shown in the right panel of Figure \ref{fig:detection}, but zoomed out and on a different color scale to show the apparent trajectories of Puck and Miranda. Mab's position is marked with a purple circle. The expected motion of Puck and Miranda relative to Mab are plotted as red and orange lines, respectively. Miranda is still overexposed in this image stretch, so the brightest pixels in Miranda's track are highlighted in cyan.}
\label{fig:astrometry}
\script{relative_position_miranda_puck.py}
\end{figure}

A very faint region of positive flux was observed at the expected position of Mab after stacking the Kp-band data (see Figure \ref{fig:detection}). This feature is not clearly distinguishable by eye from positive noise spikes elsewhere in the frame. The false positive rate experiment discussed in Appendix \ref{s:falsepositives} shows that a noise spike of similar brightness would appear within $\sim$50 pixels of the expected position $\sim$\variable{output/perturbation_percent_higher_K.txt}\% of the time. However, our uncertainty in Mab's position is roughly one H-band PSF FWHM, or $\pm 2$ pixels, because we detected Mab at the expected position in H-band. We therefore label this a tentative detection. Photometry was performed in an identical way as for the H-band data, and we found a flux of 
(\variable{output/Mab_urk_flux.txt} $\pm$ \variable{output/Mab_urk_fluxerr.txt})$\times10^{-16}$ \ergsec{} 
. This corresponds to an integrated I/F of 
\variable{output/Mab_urk_intif.txt} $\pm$ \variable{output/Mab_urk_intiferr.txt} km$^{2}$ 
at 2.1 $\mu$m, again at phase angle 0.02$^\circ$.


\subsection{Photometry of Other Moons}

We report the detection of Ophelia in H- and Kp-band and Perdita in H-band [CHECK K-BAND AGAIN].
Something about Cordelia! do we actually see it?
tie in story about median subtraction of frames.
Try Cupid again.

\section{Discussion}
\label{s:discussion}

The infrared brightness of Mab was approximately a factor of two fainter than that observed by \citet{showalter06} with HST at 0.5 $\mu$m. We compare the I/F of Mab in the three available filters (HST clear, H, Kp) with I/F values in the same filters for Puck and Miranda \citep{karkoschka01, gibbard05, paradis23} in Figure \ref{fig:spectrum} assuming Mab has either a 6-km or 12-km radius. Ratios between these filters are compiled in Table \ref{tab:color}. The visible/H ratio of Mab, which has the lowest uncertainty, is within 1$\sigma$ of Miranda's visible/H ratio but $\sim$2$\sigma$ away from Puck's. We therefore marginally prefer the interpretation that Mab is a 6-km body with a Miranda-like water-ice-rich surface; however, the alternative interpretation that Mab is a 12-km body with a Puck-like surface rich in organic aerosols cannot be ruled out by the available data.

\variable{output/color_table.tex}


\begin{figure}
\includegraphics[width=0.7\textwidth]{figures/reflectance_spectrum.png}
\caption{Comparison between the spectra of Mab, Miranda, and Puck. HST data for Puck and Miranda are from \citet{karkoschka01} ($\alpha$ = 0.034$^\circ$). Keck H- and Kp-band data for Miranda are from \citet{gibbard05} (rescaled from $\alpha$ = 1.9$^\circ$ to Mab's observed $\alpha$ = 0.02$^\circ$ using the \citet{karkoschka01} photometric model). Keck H- and Kp-band data for Puck are from \citet{paradis23} ($\alpha$ = 0.02$^\circ$). HST Mab data are from \citet{showalter06} ($\alpha$ = 0.08$^\circ$.)}
\label{fig:spectrum}
\script{compute_if.py}
\end{figure}

Our reported H-band flux of 
(\variable{output/Mab_urh_flux.txt} $\pm$ \variable{output/Mab_urh_fluxerr.txt})$\times10^{-16}$ \ergsec{} 
is seemingly in tension with the 3$\sigma$ upper limit of $2.4 \times 10^{-16}$ \ergsec{} derived previously \citep[][]{paradis19}, which we have rescaled to account for updated photometric calibration constants reported in \citet{paradis23}. However, those observations were taken at a phase angle of $0.65^\circ$. If we rescale the limit to the $0.02^\circ$ phase angle of our observations according to the \citet{karkoschka01} photometric model for Miranda, the limit would be $3.2 \times 10^{-16}$ \ergsec{}, within 2$\sigma$ of our derived result and therefore statistically insignificant. The \citet{paradis23} requirement that Mab's H-band geometric albedo be $<0.11$ for a 6-km effective radius is disfavored by our data at the 2.0$\sigma$ level.

%The photometric model of \citet{karkoschka01} defines the I/F of a moon as the product of four normalized functions and a constant:
%\begin{equation}
%	\label{eq:if}
%	I/F(l, \alpha, \lambda) = f_1(l) f_2(\alpha) f_3(\lambda) f_4(\lambda) (I/F)_0
%\end{equation}
%where $f_1(l)$ is the lightcurve as a function of orbital longitude $l$ with an orbital average of unity, $f_2(\alpha)$ is the phase function scaled to unity at phase angle $\alpha = 0$, $f_3(\lambda)$ is the solar spectrum (the ``continuum'') at the observed wavelength $\lambda$ scaled to unity at 550 nm, $f_4(\lambda)$ is the band/continuum ratio, used to account for wavelength-dependent absorption features in the spectrum of the moon, and $(I/F)_0$ is the reflectivity at $\alpha = 0$ and $\lambda = 550$ nm, averaged over orbital longitude.


\begin{acknowledgements}

The data presented herein were obtained at the W. M. Keck Observatory, which is operated as a scientific partnership among the California Institute of Technology, the University of California and the National Aeronautics and Space Administration. The Observatory was made possible by the generous financial support of the W. M. Keck Foundation.

The authors wish to recognize and acknowledge the very significant cultural role and reverence that the summit of Maunakea has always had within the indigenous Hawaiian community.  We are most fortunate to have the opportunity to conduct observations from this mountain.

This study was carried out using the reproducibility software
\href{https://github.com/showyourwork/showyourwork}{\showyourwork}
\citep{luger21}, which leverages continuous integration to
programmatically download the data from
\href{https://zenodo.org/}{zenodo.org}, create the figures, and
compile the manuscript. Each figure caption contains two links: one
to the dataset stored on zenodo used in the corresponding figure,
and the other to the script used to make the figure (at the commit
corresponding to the current build of the manuscript). The git
repository associated to this study is publicly available at
\url{https://github.com/emolter/mab}, and the release
v.X.X allows anyone to re-build the entire manuscript. The datasets
are stored at \url{https://doi.org/whatever}.

\end{acknowledgements}

\software{
Astropy \citep{astropy:2013, astropy:2018, astropy:2022},
Astroquery \citep{ginsburg19},
matplotlib \citep{matplotlib07},
numpy \citep{numpy20},
photutils \citep{photutils140},
pylanetary \citep{pylanetary23},
scikit-image \citep{skimage14},
scipy \citep{scipy20},
shift\_stack\_moons \cite{shift_stack_moons23}
}
% other \software here!

\facility{Keck:II}

\appendix

\restartappendixnumbering

\section{Shift-and-Stack Procedure}
\label{s:shiftandstack}

To improve the SNR on Mab, individual 120-second frames were shifted according to the expected position of the moon relative to Uranus and then co-added; details of this procedure are presented here. The accuracy of the shift-and-stack procedure depends sensitively on the rotation angle of the detector, so we corrected for the 0.26$^\circ$ angular offset between NIRC2's sky north position and true sky north before starting \citep{service16}. First, we aligned the position of Uranus in all the frames using the \texttt{chi2\_shift} function of the \texttt{Astropy}-affiliated \texttt{image\_registration} Python package\footnote{\url{https://github.com/keflavich/image_registration}}, which implements the single-step discrete Fourier transform (DFT) algorithm for efficient sub-pixel image registration \citep{guizarsicairos08}. In Kp-band, cloud features and moons are brighter than the planet's disk, so we first applied a Canny edge-detection filter using the \texttt{skimage} Python package \citep{skimage14} to enhance the rings of Uranus, then ran \texttt{chi2\_shift} on those edges. This alignment method was found to produce very sharp stacked images of the rings, so we were confident that it was aligning the frames accurately. The implementation of this alignment step permitted us to co-add all three H-band observing blocks (and two Kp-band observing blocks) shown in Figure \ref{fig:detection}, between which Uranus was repositioned on the detector by tens of pixels.  Second, we found the median of these planet-aligned frames and subtracted it from each frame; this step suppresses the signal of non-moving sources (in this case, the planet and rings), decreasing the effects of scattered light. Third, the expected offset between Mab and Uranus at the time\footnote{Start time plus half the exposure time} of each exposure was taken from JPL Horizons, accessed using the \texttt{Astroquery} Python package \citep{ginsburg19}. We converted the expected x,y offset from units of arcseconds to pixels assuming the pixel scale of the NIRC2 narrow camera to be 0.009971\arcsec \citep{service16}. Finally, we applied the shifts using a 2-D fast Fourier transform (FFT) sub-pixel image shift, again implemented with \texttt{image\_registration}, and summed all the frames to produce a single stacked frame. Our shift-and-stack code is publicly available on GitHub \citep{molter23}.


\section{Flux Bootstrapping Technique}
\label{s:bootstrapping}

Using the \texttt{astropy}-affiliated \texttt{photutils} package \citep{photutils140}, we measured the total flux inside many circular apertures of different radii $r_i$ centered on Mab; let us call Mab's flux for the $i$th radius $F_{M i}$. We then measured the flux inside apertures of the same size but centered on the standard star; call these $F_{\star i}$. Comparing $F_{\star i}$ with the true flux of the standard star $F_\star$ (as measured in a very large aperture of radius $\gtrsim$100 pixels) yielded a correction at a given value of $r_{i}$ given by simply $C_{psf} = F_{\star i}/F_\star$. The flux of the background must be subtracted in order to accurately determine $F_{M i}$; we defined the background region using a circular annulus centered on Mab with inner radius $r_i + 5$ pixels and outer radius $r_o$. The background flux level $F_{B o}$ was taken to be the median of pixels within the background annulus multiplied by the area of the Mab aperture $\pi r_i^2$. We also varied $r_o$ over a range of values to test the sensitivity of our flux estimate to the choice of background region. The flux of Mab $F_{i,o}$ for a given $r_i, r_o$ pair is given by $F_M = (F_{M i} - F_{B o}) / C_{psf}$.
%, and the value of $F_{i,o}$ is displayed as a function of $r_i$ and $r_o$ in Figure \ref{fig:wing}. 
The final flux estimate of Mab is given by the mean of $F_{i,o}$ over a reasonable range of $r_i$ and $r_o$ values, which we take to be 6-10 pixels and 15-50 pixels, respectively. The uncertainty is given by the standard deviation of $F_{i,o}$, which was $\approx$15\% in both H- and Kp-band. This error was multiplied in quadrature with the typical 20\% flux calibration error from standard star observations with Keck.

%\begin{figure}
%\includegraphics[width=0.3\textwidth]{figures/example_aperture.png}
%\includegraphics[width=0.7\textwidth]{figures/photometry_vs_region.png}
%\caption{\textbf{Left:} Example aperture (solid blue line) and background annulus (dot-dashed red line) centered on Mab. The values of $r_i$ and $r_o$ in this example are 7 and 45 pixels, respectively. \textbf{Right:} Derived flux of Mab as a function of $r_i$ and $r_o$.\label{fig:wing}}
%\end{figure}


\section{False Positive Rate Experiment}
\label{s:falsepositives}

Mab was observed in the lower-left quadrant of the NIRC2 NARROW camera, which is known to have non-Gaussianity in its noise statistics,\footnote{https://www2.keck.hawaii.edu/inst/nirc2/ObserversManual.html} including vertical stripes of correlated noise. Given the low SNR of the detection, it is natural to wonder whether the shift-and-stack technique is injecting false positives by stacking noise spikes atop one another. To test whether this is the case, we performed an experiment to test the false positive rate within the same detector noise and scattered light environment of the data, as follows. The expected position of Mab was shifted by a random x,y offset of mean amplitude 20 pixels in each frame, then the shift-and-stack algorithm was re-run assuming these new randomly-selected shifts and the output frame was saved. This experiment was repeated 100 times with different random offsets applied. We then searched for point sources in these 100 test stacks by applying a center-surround (difference-of-Gaussians) filter with an FWHM of 4 pixels for the inner Gaussian\footnote{This corresponds roughly to the diffraction-limited beam size of Keck in H-band.} and an FWHM of 12 pixels for the outer Gaussian. The center-surround filter is the appropriate choice because it accentuates features at the desired spatial frequency and downweights low spatial frequency features. The visual systems of humans and other animals employ center-surround antagonism \citep{graham06}, so this technique is a reasonable proxy for ``by-eye'' detection. We binned the filtered images by a factor of 2 in each direction. Finally, we computed the amplitude of the brightest pixel in each binned frame in units of the RMS noise of the input image. This yielded a rough estimate of the signal-to-noise ratio of that peak. Identical filtering, binning, and SNR calculations were run on the real data. The detection of Mab in the real data was found to have a higher SNR than any peak in any of the 100 test frames in H-band (see Figure \ref{fig:randomstack}). In Kp-band, we find that a noise spike with an amplitude higher than our tentative detection is present in 8 out of 100 frames (Figure \ref{fig:randomstack_K}). However, because our tentative detection is in the correct position on the detector relative to Miranda and Puck, we feel justified in labeling it a tentative detection rather than a non-detection. We tested other choices of inner and outer FWHM for the center-surround filter and different amounts of binning, and found that the results remained similar within reasonable ranges of these parameters. The SNR values reported in Figures \ref{fig:randomstack} and \ref{fig:randomstack_K} may look surprisingly high; note that they represent the detection level above the per-pixel RMS noise in the image, but these values do not correlate well with the true confidence level of a detection due to the substantial spatial correlation of the noise.

\begin{figure}
\includegraphics[width=1.0\textwidth]{figures/random_stack_experiment_Mab_H.png}
\caption{Results of the false positive rate experiment for H band. \textbf{(a)} Detection of Mab shown in Figure \ref{fig:detection}. \textbf{(b)} Panel (a) after filtering and binning were applied. \textbf{(c)} Example filtered and binned randomized stack. \textbf{(d)} Histogram of the SNR of the brightest pixel in the filtered and binned test frames; the real data are demarcated with a black dashed line.}
\label{fig:randomstack}
\script{plot_perturbation_experiment.py}
\end{figure}

\begin{figure}
\includegraphics[width=1.0\textwidth]{figures/random_stack_experiment_Mab_K.png}
\caption{Results of the false positive rate experiment for Kp band. See caption of Figure \ref{fig:randomstack} for a description. }
\label{fig:randomstack_K}
\script{plot_perturbation_experiment.py}
\end{figure}



\bibliography{references}

\end{document}
